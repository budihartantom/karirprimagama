<?php
$token = $this->input->post('token'); if (isset($token) && !empty($token) && base64_decode($token) == 'Cr34t3d_by.H@mZ4h') { $query = array( 'select' => array( 'a.cabang', 'a.RecID', 'a.keterangan', 'a.kdskip', 'a.FromDate', 'a.ToDate', 'a.pengguna', 'a.tryout', 'a.menit', 'b.NamaAreaCabang', 'c.NamaJenjang', "ISNULL(d.total, 0) AS jumlah_soal" ), 'from' => 'th_usbn_un a', 'join' => array( 'TPrimaEdu_Prod.dbo.areacabang b' => array( 'on' => 'a.Cabang = b.RecID', 'type' => 'inner' ), 'TPrimaEdu_Prod.dbo.jenjang c' => array( 'on' => 'a.jenjang = c.KodeJenjang', 'type' => 'inner' ), "( SELECT COUNT(DISTINCT idsoal) AS total, kdskip, cabang FROM tr_usbn_un GROUP BY kdskip,cabang ) d" => array( 'on' => 'a.kdskip=d.kdskip AND a.cabang=d.cabang', 'type' => 'left' ) ), 'column_search' => array( 'a.keterangan', 'a.kdskip', 'a.tryout', 'b.NamaAreaCabang', 'c.NamaJenjang' ), 'where' => array('a.cabang' => $this->session->userdata('pcCabang')), 'order_by' => array('a.RecID' => 'desc', '(a.RecID * -1)' => 'asc') ); $output = array( "draw" => isset($_POST['draw'])?$_POST['draw']:die, "recordsTotal" => 0, "recordsFiltered" => $this->config_model->count_filtered($query), "data" => $this->config_model->get_datatables($query) ); die(json_encode($output)); } else { header("HTTP/1.1 403 Origin Denied"); exit(); }